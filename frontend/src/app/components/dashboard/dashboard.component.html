<div class="dashboard-container container-fluid py-4">

  <!-- Loading -->
  <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center" style="min-height: 400px;">
    <div class="text-center">
      <div class="spinner-border text-light mb-3" role="status" style="width: 3rem; height: 3rem;"></div>
      <p class="text-white fs-5">Chargement du tableau de bord...</p>
    </div>
  </div>

  <!-- Error -->
  <div *ngIf="hasError" class="alert alert-danger text-center">
    <i class="bi bi-exclamation-triangle-fill fs-2 mb-2"></i>
    <h5>Erreur de chargement</h5>
    <p>{{ errorMessage }}</p>
    <button class="btn btn-outline-danger btn-sm" (click)="refreshData()">RÃ©essayer</button>
  </div>

  <!-- Contenu du dashboard -->
  <div *ngIf="!isLoading && !hasError">

    <!-- Welcome -->
    <div class="mb-4 d-flex justify-content-between align-items-center">
      <div>
        <h1 class="text-white display-6">
          {{ getGreeting() }} {{ userProfile?.firstName }} ðŸ‘‹
        </h1>
        <p class="text-white-50 mb-0">
          AperÃ§u de vos finances
        </p>
        <small class="text-white-50">
          <small class="text-white-50">
            DerniÃ¨re mise Ã  jour : {{ today }}
          </small>
        </small>
      </div>
      <div>
        <button class="btn btn-outline-light me-2" (click)="refreshData()" [disabled]="isRefreshing">
          <i class="bi bi-arrow-clockwise" [class.spinning]="isRefreshing"></i> Actualiser
        </button>
        <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
          <i class="bi bi-three-dots"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" (click)="exportAccountData()"><i class="bi bi-download"></i> Exporter</a></li>
          <li><a class="dropdown-item" routerLink="/profile"><i class="bi bi-person-gear"></i> ParamÃ¨tres</a></li>
        </ul>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="row mb-4">
      <div class="col-md-4 mb-3">
        <div class="card text-white bg-success h-100">
          <div class="card-body">
            <h6>Solde Total</h6>
            <h3>{{ formatCurrency(stats.totalBalance) }}</h3>
            <small>RÃ©parti sur {{ stats.accountsCount }} compte{{ stats.accountsCount > 1 ? 's' : '' }}</small>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100">
          <div class="card-body">
            <h6>Mes Comptes</h6>
            <h3>{{ stats.accountsCount }}</h3>
            <small>{{ stats.accountsCount }} actif{{ stats.accountsCount > 1 ? 's' : '' }}</small>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100">
          <div class="card-body">
            <h6>Transferts ce mois</h6>
            <h3>{{ stats.transfersThisMonth }}</h3>
            <div class="d-flex justify-content-between">
              <small class="text-success">+{{ formatCurrency(getTotalIncomingThisMonth()) }}</small>
              <small class="text-danger">-{{ formatCurrency(getTotalOutgoingThisMonth()) }}</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4 text-center">
      <div class="col">
        <button class="btn btn-light me-2" routerLink="/transfer"><i class="bi bi-send-fill fs-3"></i> Nouveau Transfert</button>
        <button class="btn btn-outline-light me-2" (click)="quickTransferToFrequent()"><i class="bi bi-arrow-repeat fs-3"></i> Transfert Rapide</button>
        <button class="btn btn-outline-light me-2" routerLink="/accounts"><i class="bi bi-wallet2 fs-3"></i> GÃ©rer Comptes</button>
        <button class="btn btn-outline-light" routerLink="/history"><i class="bi bi-clock-history fs-3"></i> Historique</button>
      </div>
    </div>

  </div>

</div>
